{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { batch, useDispatch } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\nimport { setLogin } from 'store/action/UserDataAction';\nimport { CustomGet, CustomPost, SuspenseGet } from 'utils/api';\nexport const useLogin = () => {\n  _s();\n\n  const dispatch = useDispatch(); // const navigate = useNavigate();\n\n  const [loginSuccess, setLoginSuccess] = useState(false);\n\n  const SuspenseLoginWithJwt = _ref => {\n    let {\n      jwt = ''\n    } = _ref;\n    return SuspenseGet({\n      url: `/web/auto-login`,\n      headers: {\n        'x-access-token': jwt\n      }\n    });\n  };\n\n  async function LoginWithjwt(data) {\n    const result = await CustomGet({\n      url: '/web/auto-login',\n      headers: {\n        'x-access-token': data.jwt\n      }\n    });\n    console.log(result);\n\n    switch (result.code) {\n      case 1001:\n        // 로그인 성공\n        console.log(result);\n        setLoginSuccess(true);\n        batch(() => {\n          dispatch(setLogin({\n            jwt: data.jwt,\n            profileImageUrl: result.result.profileImageUrl,\n            userId: result.result.userId\n          }));\n        });\n        break;\n\n      default:\n    }\n  }\n\n  async function LoginWithEmail(data) {\n    const result = await CustomPost({\n      url: '/web/login',\n      body: {\n        email: data.email,\n        password: data.password\n      }\n    });\n\n    switch (result.code) {\n      case 1004:\n        // 로그인 성공\n        console.log(result);\n        setLoginSuccess(true);\n        batch(() => {\n          dispatch(setLogin({\n            jwt: result.result.jwt,\n            profileImageUrl: result.result.profileImageUrl,\n            userId: result.result.userId\n          })); // dispatch(setLoginModalInvisible());\n        });\n        localStorage.setItem('jwt', result.result.jwt);\n        break;\n\n      default:\n    }\n  }\n\n  return {\n    LoginWithjwt,\n    SuspenseLoginWithJwt,\n    LoginWithEmail,\n    loginSuccess\n  };\n};\n\n_s(useLogin, \"ar+CvL+zBU8kMc4/jjKh5WfEhdQ=\", false, function () {\n  return [useDispatch];\n});","map":{"version":3,"names":["React","useState","batch","useDispatch","useNavigate","setLogin","CustomGet","CustomPost","SuspenseGet","useLogin","dispatch","loginSuccess","setLoginSuccess","SuspenseLoginWithJwt","jwt","url","headers","LoginWithjwt","data","result","console","log","code","profileImageUrl","userId","LoginWithEmail","body","email","password","localStorage","setItem"],"sources":["C:/Users/cksgo/Desktop/RC7/Rising_Test/wanted_web_pyengchangbori/src/hoc/useLogin.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { batch, useDispatch } from 'react-redux';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { setLogin } from 'store/action/UserDataAction';\r\nimport { CustomGet, CustomPost, SuspenseGet } from 'utils/api';\r\n\r\nexport const useLogin = () => {\r\n\tconst dispatch = useDispatch();\r\n\t// const navigate = useNavigate();\r\n\tconst [loginSuccess, setLoginSuccess] = useState(false);\r\n\r\n\tconst SuspenseLoginWithJwt = ({ jwt = '' }) =>\r\n\t\tSuspenseGet({\r\n\t\t\turl: `/web/auto-login`,\r\n\t\t\theaders: {\r\n\t\t\t\t'x-access-token': jwt,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\tasync function LoginWithjwt(data) {\r\n\t\tconst result = await CustomGet({\r\n\t\t\turl: '/web/auto-login',\r\n\t\t\theaders: {\r\n\t\t\t\t'x-access-token': data.jwt,\r\n\t\t\t},\r\n\t\t});\r\n\t\tconsole.log(result);\r\n\r\n\t\tswitch (result.code) {\r\n\t\t\tcase 1001:\r\n\t\t\t\t// 로그인 성공\r\n\t\t\t\tconsole.log(result);\r\n\t\t\t\tsetLoginSuccess(true);\r\n\t\t\t\tbatch(() => {\r\n\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\tsetLogin({\r\n\t\t\t\t\t\t\tjwt: data.jwt,\r\n\t\t\t\t\t\t\tprofileImageUrl: result.result.profileImageUrl,\r\n\t\t\t\t\t\t\tuserId: result.result.userId,\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t}\r\n\t}\r\n\r\n\tasync function LoginWithEmail(data) {\r\n\t\tconst result = await CustomPost({\r\n\t\t\turl: '/web/login',\r\n\t\t\tbody: {\r\n\t\t\t\temail: data.email,\r\n\t\t\t\tpassword: data.password,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tswitch (result.code) {\r\n\t\t\tcase 1004:\r\n\t\t\t\t// 로그인 성공\r\n\t\t\t\tconsole.log(result);\r\n\t\t\t\tsetLoginSuccess(true);\r\n\t\t\t\tbatch(() => {\r\n\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\tsetLogin({\r\n\t\t\t\t\t\t\tjwt: result.result.jwt,\r\n\t\t\t\t\t\t\tprofileImageUrl: result.result.profileImageUrl,\r\n\t\t\t\t\t\t\tuserId: result.result.userId,\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t);\r\n\t\t\t\t\t// dispatch(setLoginModalInvisible());\r\n\t\t\t\t});\r\n\t\t\t\tlocalStorage.setItem('jwt', result.result.jwt);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t}\r\n\t}\r\n\r\n\treturn { LoginWithjwt, SuspenseLoginWithJwt, LoginWithEmail, loginSuccess };\r\n};\r\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,KAAT,EAAgBC,WAAhB,QAAmC,aAAnC;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,QAAT,QAAyB,6BAAzB;AACA,SAASC,SAAT,EAAoBC,UAApB,EAAgCC,WAAhC,QAAmD,WAAnD;AAEA,OAAO,MAAMC,QAAQ,GAAG,MAAM;EAAA;;EAC7B,MAAMC,QAAQ,GAAGP,WAAW,EAA5B,CAD6B,CAE7B;;EACA,MAAM,CAACQ,YAAD,EAAeC,eAAf,IAAkCX,QAAQ,CAAC,KAAD,CAAhD;;EAEA,MAAMY,oBAAoB,GAAG;IAAA,IAAC;MAAEC,GAAG,GAAG;IAAR,CAAD;IAAA,OAC5BN,WAAW,CAAC;MACXO,GAAG,EAAG,iBADK;MAEXC,OAAO,EAAE;QACR,kBAAkBF;MADV;IAFE,CAAD,CADiB;EAAA,CAA7B;;EAQA,eAAeG,YAAf,CAA4BC,IAA5B,EAAkC;IACjC,MAAMC,MAAM,GAAG,MAAMb,SAAS,CAAC;MAC9BS,GAAG,EAAE,iBADyB;MAE9BC,OAAO,EAAE;QACR,kBAAkBE,IAAI,CAACJ;MADf;IAFqB,CAAD,CAA9B;IAMAM,OAAO,CAACC,GAAR,CAAYF,MAAZ;;IAEA,QAAQA,MAAM,CAACG,IAAf;MACC,KAAK,IAAL;QACC;QACAF,OAAO,CAACC,GAAR,CAAYF,MAAZ;QACAP,eAAe,CAAC,IAAD,CAAf;QACAV,KAAK,CAAC,MAAM;UACXQ,QAAQ,CACPL,QAAQ,CAAC;YACRS,GAAG,EAAEI,IAAI,CAACJ,GADF;YAERS,eAAe,EAAEJ,MAAM,CAACA,MAAP,CAAcI,eAFvB;YAGRC,MAAM,EAAEL,MAAM,CAACA,MAAP,CAAcK;UAHd,CAAD,CADD,CAAR;QAOA,CARI,CAAL;QASA;;MACD;IAfD;EAiBA;;EAED,eAAeC,cAAf,CAA8BP,IAA9B,EAAoC;IACnC,MAAMC,MAAM,GAAG,MAAMZ,UAAU,CAAC;MAC/BQ,GAAG,EAAE,YAD0B;MAE/BW,IAAI,EAAE;QACLC,KAAK,EAAET,IAAI,CAACS,KADP;QAELC,QAAQ,EAAEV,IAAI,CAACU;MAFV;IAFyB,CAAD,CAA/B;;IAQA,QAAQT,MAAM,CAACG,IAAf;MACC,KAAK,IAAL;QACC;QACAF,OAAO,CAACC,GAAR,CAAYF,MAAZ;QACAP,eAAe,CAAC,IAAD,CAAf;QACAV,KAAK,CAAC,MAAM;UACXQ,QAAQ,CACPL,QAAQ,CAAC;YACRS,GAAG,EAAEK,MAAM,CAACA,MAAP,CAAcL,GADX;YAERS,eAAe,EAAEJ,MAAM,CAACA,MAAP,CAAcI,eAFvB;YAGRC,MAAM,EAAEL,MAAM,CAACA,MAAP,CAAcK;UAHd,CAAD,CADD,CAAR,CADW,CAQX;QACA,CATI,CAAL;QAUAK,YAAY,CAACC,OAAb,CAAqB,KAArB,EAA4BX,MAAM,CAACA,MAAP,CAAcL,GAA1C;QACA;;MACD;IAjBD;EAmBA;;EAED,OAAO;IAAEG,YAAF;IAAgBJ,oBAAhB;IAAsCY,cAAtC;IAAsDd;EAAtD,CAAP;AACA,CAxEM;;GAAMF,Q;UACKN,W"},"metadata":{},"sourceType":"module"}